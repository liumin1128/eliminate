(this.webpackJsonpanimal=this.webpackJsonpanimal||[]).push([[0],{160:function(t,e,n){},161:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(1),r=n.n(i),s=n(51),o=n.n(s),c=(n(62),n(63),n(10)),u=n(26),h=n.n(u),d=n(4),f=n.n(d),m=n(9),v=n(52),l=n(53),x=n(54),g=n.n(x),p=n(55),b=n.n(p),y=n(56),j=n(27),O=function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",n=e.length,a="",i=0;i<t;i+=1)a+=e.charAt(Math.floor(Math.random()*n));return a},k=function(t){return new Promise((function(e,n){return setTimeout(e,t)}))};function I(){var t=["chicken","frog","sea-lion","bear","dog"];return t[Math.floor(Math.random()*t.length)]}var C=function(){function t(e,n){var a=this;Object(v.a)(this,t),this.init=function(t){var e=t.onDataChange,n=t.onScoreChange,i=t.onTimeChange;j.Howler.volume(.5),a.sound={},["d1","d2","keyboard"].map((function(t){a.sound[t]=new j.Howl({src:["./audios/"+t+".mp3"],onplayerror:function(t){this.sound.once("unlock",(function(){this.sound.play()}))},volume:.5,onend:function(){}})})),a.onDataChange=e,a.onScoreChange=n,a.onTimeChange=i,a.start()},this.timeLoop=function(){a.time>0?(a.time=a.time-1e3,a.onTimeChange(a.time),setTimeout((function(){a.timeLoop()}),1e3)):(alert("game over, socre:"+a.score),a.start())},this.getData=function(){return a.data},this.update=function(){a.onDataChange(a.data)},this.click=function(){var t=Object(m.a)(f.a.mark((function t(e){var n,i;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.sound.keyboard.play(),n=a.data.findIndex((function(t){return t.select})),i=a.data.findIndex((function(t){return t.x===e.x&&t.y===e.y})),-1!=n?n===i?a.data=a.data.setIn([i,"select"],!1):(a.a2b(n,i),a.data=a.data.setIn([n,"select"],!1)):a.data=a.data.setIn([i,"select"],!0),a.update();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),this.touchMove=function(){var t=Object(m.a)(f.a.mark((function t(e,n,i,r){var s,o;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:s=a.data.findIndex((function(t){return t.x===e&&t.y===n})),o=a.data.findIndex((function(t){return t.x===i&&t.y===r})),a.a2b(s,o),a.update();case 4:case"end":return t.stop()}}),t)})));return function(e,n,a,i){return t.apply(this,arguments)}}(),this.maxX=e,this.maxY=n}return Object(l.a)(t,[{key:"start",value:function(){this.score=0,this.combo=0,this.time=3e4,this.data=Object(y.a)(function(t,e){for(var n=[],a=0;a<t;a++)for(var i=0;i<e;i++){var r=I();n.push({id:O(),x:a,y:i,animal:r,select:!1})}return n}(this.maxX,this.maxY)),this.onDataChange(this.data),this.onScoreChange(this.score),this.onTimeChange(this.time),this.checkStatus(),this.timeLoop()}},{key:"getRemoveList",value:function(t){var e={x:"y",y:"x"},n={x:this.maxX,y:this.maxY};function a(t,a,i){var r,s=0,o=0,c=[];function u(e){var n,r,s;return"x"===i&&(n=e,r=a),"y"===i&&(n=a,r=e),s=t.findIndex((function(t){return t.x===n&&t.y===r})),{x:n,y:r,idx:s}}return function h(){var d=function(n){return t.find((function(t){return t[i]===n&&t[e[i]]===a}))}(o);if(!d&&(r=null,o<n[i]-1))return o+=1,void h();if(r||(r=d),r.animal!==d.animal){if(o-1-s>1)for(var f=s;f<=o-1;f++)c.push(u(f));s=o}if(o!==n[i]-1)return o<n[i]-1?(o+=1,r=d,void h()):void 0;if(o-s>1)for(var m=s;m<=o;m++)c.push(u(m))}(),c}for(var i=[],r=0;r<this.maxY;r++)i.push(a(t,r,"x"));for(var s=0;s<this.maxX;s++)i.push(a(t,s,"y"));var o=g()(i);return i=b()(o,(function(t){return t.idx}))}},{key:"setRemoveStatus",value:function(t,e){var n=this.data;return t.map((function(t){var a=t.idx;n=n.setIn([a,"status"],e)})),n}},{key:"setRemovePosition",value:function(t){var e=this.data,n={};return t.map((function(t){var a=t.idx,i=t.x;t.y;void 0===n[i]?n[i]=-1:n[i]=n[i]-1,e=e.setIn([a,"y"],n[i]).setIn([a,"animal"],I())})),e}},{key:"getDownList",value:function(){for(var t=this,e=this.data,n=function(n){for(var a=0,i=function(i){var r=t.data.findIndex((function(t){return t.x===n&&t.y===i}));-1!==r&&(e=e.setIn([r,"y"],a),a++)},r=-t.maxY;r<t.maxY;r++)i(r)},a=0;a<this.maxX;a++)n(a);this.data=e}},{key:"a2b",value:function(t,e){var n=this.data.getIn([t,"x"]),a=this.data.getIn([t,"y"]),i=this.data.getIn([e,"x"]),r=this.data.getIn([e,"y"]);if(Math.abs(n-i)+Math.abs(a-r)==1){var s=this.data.setIn([t,"x"],i).setIn([t,"y"],r).setIn([e,"x"],n).setIn([e,"y"],a),o=this.getRemoveList(s);o.length>0&&(this.data=s,this.remove(o))}}},{key:"remove",value:function(){var t=Object(m.a)(f.a.mark((function t(e){return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.sound.d1.play(),this.score=this.score+e.length*this.combo*100,this.onScoreChange(this.score),this.time=this.time+1e3,this.time>3e4&&(this.time=3e4),this.onTimeChange(this.time),this.data=this.setRemoveStatus(e,"removing"),this.update(),t.next=10,k(1e3);case 10:return this.data=this.setRemoveStatus(e,"removed"),this.update(),t.next=14,k(30);case 14:return this.data=this.setRemovePosition(e),this.update(),t.next=18,k(30);case 18:return this.data=this.setRemoveStatus(e,"ok"),this.update(),t.next=22,k(30);case 22:return this.getDownList(),this.update(),t.next=26,k(300);case 26:this.checkStatus();case 27:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"checkStatus",value:function(){var t=Object(m.a)(f.a.mark((function t(){var e;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==(e=this.getRemoveList(this.data)).length){t.next=3;break}return t.abrupt("return");case 3:if(0!==e.length){t.next=6;break}return this.combo=0,t.abrupt("return");case 6:return this.combo=this.combo+1,t.next=9,this.remove(e);case 9:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),t}(),S=(n(159),n(160),new C(9,9)),w=function(){var t=Object(i.useState)(null),e=Object(c.a)(t,2),n=e[0],r=e[1],s=Object(i.useState)(0),o=Object(c.a)(s,2),u=o[0],d=o[1],f=Object(i.useState)(0),m=Object(c.a)(f,2),v=m[0],l=m[1],x=Object(i.useState)(0),g=Object(c.a)(x,2),p=g[0],b=g[1];return Object(i.useEffect)((function(){b(document.querySelector(".root").offsetWidth/9)}),[]),Object(a.jsx)("div",{className:"root",children:n?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"header",children:[Object(a.jsxs)("h1",{children:["Score: ",u]}),Object(a.jsxs)("h1",{children:["Time: ",v/1e3]})]}),Object(a.jsx)("div",{className:"list",onTouchEnd:function(t){t.preventDefault();var e=t.changedTouches[0].target,n=parseInt(e.getAttribute("data-x"),0),a=parseInt(e.getAttribute("data-y"),0),i=t.changedTouches[0].pageX,r=t.changedTouches[0].pageY,s=document.querySelector(".list").getBoundingClientRect(),o=s.x,c=s.y,u=Math.floor((i-o)/p),h=Math.floor((r-c)/p);S.touchMove(n,a,u,h)},style:{paddingTop:"100%"},children:n.map((function(t){return Object(a.jsx)("div",{onClick:function(){var e;e=t,S.click(e)},className:h()(["item",{select:t.select,removed:"removed"===t.status,removing:"removing"===t.status}]),style:{width:p,height:p,transform:"translate3d("+t.x*p+"px,"+t.y*p+"px,0)"},children:Object(a.jsx)("div",{"data-x":t.x,"data-y":t.y,className:h()(["icon","animate__animated",{animate__tada:"removing"===t.status}]),style:{width:p,height:p,backgroundImage:"url(./images/"+t.animal+".svg)"}},t.id)},t.id)}))})]}):Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{}),Object(a.jsx)("div",{className:"start",onClick:function(){S.init({onDataChange:r,onScoreChange:d,onTimeChange:l})},children:"START"})]})})};var T=function(){return Object(a.jsx)("div",{className:"App",children:Object(a.jsx)(w,{})})},M=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,162)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,r=e.getLCP,s=e.getTTFB;n(t),a(t),i(t),r(t),s(t)}))};o.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(T,{})}),document.getElementById("root")),M()},62:function(t,e,n){},63:function(t,e,n){}},[[161,1,2]]]);
//# sourceMappingURL=main.525fddc2.chunk.js.map